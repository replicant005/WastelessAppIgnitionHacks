<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Register | WasteLess</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body class="login-page">
  <div class="page-wrapper">
    <div id="headerWrapper" include-html="header.html"></div>

    <div class="login-container">
      <!-- Left image column (same as login) -->
      <div class="login-image">
        <img src="images/loginpagepicture.png" alt="Register Illustration" />
      </div>

      <!-- Right form column (same as login) -->
      <div class="login-form-section">
        <div class="login-form-wrapper">
          <img src="images/wastelessLOGOonly.png" alt="WasteLess Logo" class="logo" />
          <h1>WasteLess</h1>
          <h2>Register</h2>

          <form id="registerForm">
            <label for="regUsername">Username</label>
            <input type="text" id="regUsername" placeholder="Enter username" required />

            <label for="regEmail">Email</label>
            <input type="email" id="regEmail" placeholder="Enter your email" required />

            <div style="display:flex; gap:12px; align-items:flex-start;">
              <div style="flex:1;">
                <label for="regPassword">Password</label>
                <input type="password" id="regPassword" placeholder="Create password" required />
              </div>
            </div>

            <label for="confirmPassword">Confirm Password</label>
            <input type="password" id="confirmPassword" placeholder="Confirm password" required />

            <p id="errorMsg" class="error-msg"></p>

            <button type="submit" class="primary-btn">Register</button>
          </form>
             <p class="register-link" style="margin: 26px 0 0 0;">
                Already have an account? <a href="login.html">Log in</a>
              </p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // same functionality you had
    document.getElementById("registerForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const username = document.getElementById("regUsername").value.trim();
      const email = document.getElementById("regEmail").value.trim();
      const password = document.getElementById("regPassword").value;
      const confirmPassword = document.getElementById("confirmPassword").value;
      const errorMsg = document.getElementById("errorMsg");

      if (!username || !email || !password || !confirmPassword) {
        errorMsg.textContent = "Please fill in all fields.";
        return;
      }

      if (password !== confirmPassword) {
        errorMsg.textContent = "Passwords do not match.";
        return;
      }

      try {
        const res = await fetch("http://localhost:5000/api/users/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, email, password })
        });

        const data = await res.json();

        if (res.ok) {
          localStorage.setItem("token", data.token);
          localStorage.setItem("userId", data.userId);
          localStorage.setItem("username", data.username);
          alert("âœ… Registered successfully!");
          window.location.href = "entry-form.html";
        } else {
          errorMsg.textContent = data.message || "Registration failed.";
        }
      } catch (err) {
        errorMsg.textContent = "Something went wrong.";
        console.error(err);
      }
    });
  </script>
  <script src="main.js"></script>
</body>
</html>
